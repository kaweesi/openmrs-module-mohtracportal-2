<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!-- Beans to add to the current Application context definition -->
  
<beans>
	
    <bean id="mohtracportalUrlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">

    	<property name="interceptors">
			<list>
				<ref bean="localeChangeInterceptor" />
			</list>
		</property>

    	<property name="order">
			<value>5</value>
		</property>
		<property name="mappings">
            <props>
            	<prop key="**/redirectToActivity.portlet">mohtracportalRedirectToActivityPortletController</prop>
            	<prop key="**/welcome.portlet">mohtracportalWelcomePagePortletController</prop>
	            <prop key="module/mohtracportal/tracportal.htm">mohtracportalPortalController</prop>
	    		<prop key="module/mohtracportal/configuration.form">mohtracportalConfiguratiosController</prop>
	    		<prop key="module/mohtracportal/sponsor.form">mohtracportalFormController</prop>
	    		<prop key="module/mohtracportal/sponsors.list">mohtracportalListController</prop>
	    		<prop key="module/mohtracportal/locationsponsor.list">mohtracportalLocationSponsorViewController</prop>
	    		<prop key="module/mohtracportal/samplecodemanagement.list">mohtracportalSampleCodeListController</prop>
	    		<prop key="module/mohtracportal/locationsponsor.form">mohtracportalLocationSponsorFormController</prop>
	    		<prop key="module/mohtracportal/patientList.htm">mohtracportalPatientListController</prop>
	    		<prop key="module/mohtracportal/performance.htm">mohtracportalUserPerformanceController</prop>
	    		<prop key="module/mohtracportal/drug.list">mohtracportalDrugListController</prop>
	    	</props>
		</property>
    </bean>
	
    <!-- Controllers -->
	
	<bean id="mohtracportalWelcomePagePortletController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalWelcomePagePortletController" />
	<bean id="mohtracportalRedirectToActivityPortletController" class="org.openmrs.module.mohtracportal.web.controller.RedirectToActivityPortletController" />
		
    <bean id="mohtracportalDrugListController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalDrugListController">
		<property name="viewName"><value>module/mohtracportal/drugList</value></property>
    </bean>
	
    <bean id="mohtracportalUserPerformanceController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalUserPerformanceController">
		<property name="viewName"><value>module/mohtracportal/userPerformance</value></property>
    </bean>
	
    <bean id="mohtracportalPatientListController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPatientListController">
		<property name="viewName"><value>module/mohtracportal/patientList</value></property>
    </bean>
	
    <bean id="mohtracportalListController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalSponsorListController">
		<property name="viewName"><value>module/mohtracportal/sponsorsList</value></property>
    </bean>
	
    <bean id="mohtracportalLocationSponsorViewController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalLocationSponsorViewController">
		<property name="viewName"><value>module/mohtracportal/sponsorLocationList</value></property>
    </bean>
	
    <bean id="mohtracportalConfiguratiosController" class="org.openmrs.module.mohtracportal.web.controller.MohTracModulesConfigurations">
		<property name="viewName"><value>module/mohtracportal/configurationForm</value></property>
    </bean>
	
    <bean id="mohtracportalPortalController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalModuleFormController">
		<property name="viewName"><value>module/mohtracportal/tracPortal</value></property>
    </bean>
	
    <bean id="mohtracportalSampleCodeListController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalSampleCodeViewController">
		<property name="viewName"><value>module/mohtracportal/sampleCodeView</value></property>
    </bean>
	
    <bean id="mohtracportalFormController" class="org.openmrs.module.mohtracportal.web.controller.MohTracSponsorFormController">
		<property name="formView"><value>/module/mohtracportal/sponsorForm</value></property>
		<property name="successView"><value>/module/mohtracportal/sponsors.list?page=1</value></property>
		<property name="commandName"><value>sponsor</value></property>
		<property name="commandClass" value="org.openmrs.module.mohtracportal.Sponsor"></property>
		<property name="validator">
			<ref bean="sponsorFormValidator" />
		</property>
    </bean>
	
    <bean id="mohtracportalLocationSponsorFormController" class="org.openmrs.module.mohtracportal.web.controller.MohTracPortalLocationSponsorFormController">
		<property name="formView"><value>/module/mohtracportal/sponsorLocationForm</value></property>
		<property name="successView"><value>/module/mohtracportal/locationsponsor.list?page=1</value></property>
		<property name="commandName"><value>spLoc</value></property>
		<property name="commandClass" value="org.openmrs.module.mohtracportal.SponsorLocation"></property>
		<property name="validator">
			<ref bean="sponsorLocationFormValidator" />
		</property>
    </bean>
	
    <!-- /Controllers -->
    
    <!-- validators -->
	
	<bean id="sponsorFormValidator" class="org.openmrs.module.mohtracportal.validator.MohTracSponsorFormValidator" />
	<bean id="sponsorLocationFormValidator" class="org.openmrs.module.mohtracportal.validator.MohTracPortalSponsorLocationFormValidator" />
	
	<!-- /validators -->
	
	 <bean parent="serviceContext">
		<property name="moduleService">
			<list>
				<value>org.openmrs.module.mohtracportal.service.MohTracPortalService</value>
				<bean class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
					<property name="transactionManager">
						<ref bean="transactionManager" />
					</property>
					<property name="target">
						<bean class="org.openmrs.module.mohtracportal.impl.MohTracPortalServiceImpl">
							<property name="portalDao">
								<bean class="org.openmrs.module.mohtracportal.db.hibernate.MohTracPortalDAOImpl">
									<property name="sessionFactory">
										<ref bean="sessionFactory" />
									</property>
								</bean>
							</property>
						</bean>
					</property>
					<property name="preInterceptors">
						<list>
							<ref bean="authorizationInterceptor" />
						</list>
					</property>
					<property name="transactionAttributeSource">
						<bean class="org.springframework.transaction.annotation.AnnotationTransactionAttributeSource" />
					</property>
				</bean>
			</list>
		</property>
		
	</bean>
	
    <!-- ========================= other beans ========================= -->
 
	<bean class="org.openmrs.module.mohtracportal.util.ContextProvider" />
	
</beans>
